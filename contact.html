<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>MIDI Command Studio | Contact</title>
    <meta name="description" content="Contact MIDI Command Studio support." />
    <link rel="canonical" href="https://midicommandstudio.com/contact.html" />
    <meta property="og:site_name" content="MIDI Command Studio" />
    <meta property="og:type" content="website" />
    <meta property="og:title" content="MIDI Command Studio | Contact" />
    <meta property="og:description" content="Contact MIDI Command Studio support." />
    <meta property="og:url" content="https://midicommandstudio.com/contact.html" />
    <meta property="og:image" content="https://midicommandstudio.com/assets/Midi%20png.png" />
    <link rel="icon" href="assets/mcs_exact.ico" />
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <div class="page">
      <header class="site-header">
        <div class="site-logo">MIDI Command Studio</div>
        <nav class="site-nav">
          <a href="/">Home</a>
          <a href="features.html">Features</a>
          <a href="guides.html">Guides</a>
          <a href="free-vs-full.html">Free vs Full</a>
          <a href="help/MIDI_Command_Studio_Help.html" target="_blank" rel="noopener">Help</a>
          <a href="privacy.html">Data &amp; Privacy</a>
          <a href="faq.html">FAQ</a>
          <a class="active" href="contact.html">Contact</a>
          <a href="download.html">Download</a>
        </nav>
      </header>
      <main>
        <section class="section">
          <div class="section-head">
            <h1>Contact</h1>
            <p>In-app feedback is the fastest path, but you can also send a website message below.</p>
          </div>
          <p class="body-copy">
            For app issues, please use <strong>Settings &gt; Feedback</strong> so diagnostics can be included when
            needed. For general questions, use this contact form.
          </p>
          <div class="contact-card">
            <h2>Send a Message</h2>
            <form
              class="contact-form"
              action="https://script.google.com/macros/s/AKfycbxZoAbJy1pin8oX2TKt1QJv9eCv4GilHUfmXvMsWcz5WtrqrYhdOPH0Us-dzP4FjEReOw/exec"
              method="post"
              target="contact-submit-frame"
            >
              <label for="contact-name">Name</label>
              <input id="contact-name" name="name" type="text" required maxlength="80" />

              <label for="contact-email">Email</label>
              <input id="contact-email" name="email" type="email" required maxlength="120" />

              <label for="contact-message">Message</label>
              <textarea id="contact-message" name="message" required maxlength="4000"></textarea>

              <input
                class="contact-honeypot"
                type="text"
                name="website"
                autocomplete="off"
                tabindex="-1"
                aria-hidden="true"
              />

              <div
                class="cf-turnstile"
                data-sitekey="0x4AAAAAACgqHtr4KJl-kL-a"
                data-theme="dark"
              ></div>

              <button class="btn primary contact-submit" type="submit">Send Message</button>
              <p class="contact-note">
                Protected by Cloudflare Turnstile. You will stay on this page after submit.
              </p>
              <p id="contact-status" class="contact-note" role="status" aria-live="polite"></p>
            </form>
            <iframe
              id="contact-submit-frame"
              name="contact-submit-frame"
              class="contact-frame"
              title="Contact form response"
            ></iframe>
          </div>
        </section>
      </main>
      <footer class="footer">
        <span>&copy; 2026 Meltopia. MIDI Command Studio.</span>
      </footer>
    </div>
    <script>
      (function () {
        var form = document.querySelector(".contact-form");
        if (!form) return;
        var endpointPlaceholder = "PASTE_APPS_SCRIPT_WEB_APP_URL_HERE";
        var turnstilePlaceholder = "PASTE_TURNSTILE_SITE_KEY_HERE";
        var status = document.getElementById("contact-status");
        var submit = form.querySelector(".contact-submit");
        var widget = form.querySelector(".cf-turnstile");
        var submitFrame = document.getElementById("contact-submit-frame");
        var siteKey = (widget && widget.getAttribute("data-sitekey")) || "";
        var endpointMissing = (form.getAttribute("action") || "").indexOf(endpointPlaceholder) !== -1;
        var turnstileMissing = siteKey.indexOf(turnstilePlaceholder) !== -1;
        var COOLDOWN_MS = 60 * 1000;
        var COOLDOWN_KEY = "mcs_contact_cooldown_until";
        var pending = false;
        var fallbackTimer = null;
        var cooldownTicker = null;
        function isContactResultMessage(event) {
          if (!event) return null;
          var data = event.data;
          if (typeof data === "string") {
            try {
              data = JSON.parse(data);
            } catch (_e) {
              return null;
            }
          }
          if (!data || data.type !== "mcs_contact_result") {
            return null;
          }
          return data;
        }
        function getCooldownRemainingMs() {
          try {
            var until = Number(localStorage.getItem(COOLDOWN_KEY) || "0");
            if (!Number.isFinite(until) || until <= 0) return 0;
            return Math.max(0, until - Date.now());
          } catch (_e) {
            return 0;
          }
        }

        function setCooldown() {
          try {
            localStorage.setItem(COOLDOWN_KEY, String(Date.now() + COOLDOWN_MS));
          } catch (_e) {}
        }

        function formatCooldown(ms) {
          return Math.max(1, Math.ceil(ms / 1000));
        }

        function setCooldownStatus() {
          var remaining = getCooldownRemainingMs();
          if (pending) return;
          if (remaining > 0) {
            setSubmitEnabled(false);
            setStatus("Please wait " + formatCooldown(remaining) + " seconds before sending another message.", "is-pending");
          } else if (status && status.classList.contains("is-pending")) {
            setSubmitEnabled(true);
            setStatus("", "");
          } else {
            setSubmitEnabled(true);
          }
        }

        function startCooldownTicker() {
          if (cooldownTicker) {
            clearInterval(cooldownTicker);
            cooldownTicker = null;
          }
          cooldownTicker = setInterval(function () {
            var remaining = getCooldownRemainingMs();
            if (remaining <= 0) {
              clearInterval(cooldownTicker);
              cooldownTicker = null;
            }
            setCooldownStatus();
          }, 1000);
          setCooldownStatus();
        }

        function setStatus(message, cls) {
          if (!status) return;
          status.textContent = message || "";
          status.classList.remove("is-success", "is-error", "is-pending");
          if (cls) status.classList.add(cls);
        }

        function setSubmitEnabled(enabled) {
          if (!submit) return;
          submit.disabled = !enabled;
        }

        function clearFormAndReset() {
          try {
            form.reset();
          } catch (_e) {}
          resetTurnstile();
        }

        function resetTurnstile() {
          try {
            if (window.turnstile && typeof window.turnstile.reset === "function") {
              window.turnstile.reset();
            }
          } catch (_e) {}
        }

        function finalize(ok, message, clearForm, applyCooldown) {
          pending = false;
          if (fallbackTimer) {
            clearTimeout(fallbackTimer);
            fallbackTimer = null;
          }
          if (clearForm) {
            clearFormAndReset();
          } else {
            resetTurnstile();
          }
          if (applyCooldown) {
            setCooldown();
            startCooldownTicker();
          } else {
            setSubmitEnabled(true);
          }
          setStatus(message, ok ? "is-success" : "is-error");
        }

        if (endpointMissing || turnstileMissing) {
          setSubmitEnabled(false);
          setStatus(
            "Contact form is being configured. Add Apps Script URL and Turnstile site key, then refresh.",
            "is-error"
          );
          return;
        }

        setCooldownStatus();

        form.addEventListener("submit", function (event) {
          var remaining = getCooldownRemainingMs();
          if (remaining > 0) {
            event.preventDefault();
            setCooldownStatus();
            return;
          }
          pending = true;
          setSubmitEnabled(false);
          setStatus("Sending message...", "is-pending");
          if (fallbackTimer) {
            clearTimeout(fallbackTimer);
          }
          fallbackTimer = setTimeout(function () {
            if (!pending) return;
            finalize(
              false,
              "Submission timed out. Please try again.",
              false,
              false
            );
          }, 20000);
        });

        if (submitFrame) {
          submitFrame.addEventListener("load", function () {
            if (!pending) return;
            setTimeout(function () {
              if (!pending) return;
              finalize(
                true,
                "Message sent. Thank you - we will get back to you as soon as we can.",
                true,
                true
              );
            }, 300);
          });
        }

        window.addEventListener("message", function (event) {
          if (!pending) return;
          var data = isContactResultMessage(event);
          if (!data) return;
          if (data.ok) {
            finalize(true, data.message || "Message sent.", true, true);
          } else {
            finalize(false, data.message || "Could not send. Please try again.", false, false);
          }
        });
      })();
    </script>
    <script src="https://challenges.cloudflare.com/turnstile/v0/api.js" async defer></script>
  </body>
</html>


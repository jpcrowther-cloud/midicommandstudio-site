<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>MIDI Command Studio | Contact</title>
    <meta name="description" content="Contact MIDI Command Studio support." />
    <link rel="canonical" href="https://midicommandstudio.com/contact.html" />
    <link rel="icon" href="assets/mcs_exact.ico" />
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <div class="page">
      <header class="site-header">
        <div class="site-logo">MIDI Command Studio</div>
        <nav class="site-nav">
          <a href="index.html">Home</a>
          <a href="features.html">Features</a>
          <a href="free-vs-full.html">Free vs Full</a>
          <a href="help/MIDI_Command_Studio_Help.html" target="_blank" rel="noopener">Help</a>
          <a href="privacy.html">Data &amp; Privacy</a>
          <a href="faq.html">FAQ</a>
          <a class="active" href="contact.html">Contact</a>
          <a href="download.html">Download</a>
        </nav>
      </header>
      <main>
        <section class="section">
          <div class="section-head">
            <h1>Contact</h1>
            <p>In-app feedback is the fastest path, but you can also send a website message below.</p>
          </div>
          <p class="body-copy">
            For app issues, please use <strong>Settings &gt; Feedback</strong> so diagnostics can be included when
            needed. For general questions, use this contact form.
          </p>
          <div class="contact-card">
            <h2>Send a Message</h2>
            <form
              class="contact-form"
              action="https://script.google.com/macros/s/AKfycbxZoAbJy1pin8oX2TKt1QJv9eCv4GilHUfmXvMsWcz5WtrqrYhdOPH0Us-dzP4FjEReOw/exec"
              method="post"
              target="contact-submit-frame"
            >
              <label for="contact-name">Name</label>
              <input id="contact-name" name="name" type="text" required maxlength="80" />

              <label for="contact-email">Email</label>
              <input id="contact-email" name="email" type="email" required maxlength="120" />

              <label for="contact-message">Message</label>
              <textarea id="contact-message" name="message" required maxlength="4000"></textarea>

              <input
                class="contact-honeypot"
                type="text"
                name="website"
                autocomplete="off"
                tabindex="-1"
                aria-hidden="true"
              />

              <div
                class="cf-turnstile"
                data-sitekey="0x4AAAAAACgqHtr4KJl-kL-a"
                data-theme="dark"
              ></div>

              <button class="btn primary contact-submit" type="submit">Send Message</button>
              <p class="contact-note">
                Protected by Cloudflare Turnstile. You will stay on this page after submit.
              </p>
              <p id="contact-status" class="contact-note" role="status" aria-live="polite"></p>
            </form>
            <iframe
              id="contact-submit-frame"
              name="contact-submit-frame"
              class="contact-frame"
              title="Contact form response"
            ></iframe>
          </div>
        </section>
      </main>
      <footer class="footer">
        <span>&copy; 2026 Meltopia. MIDI Command Studio.</span>
      </footer>
    </div>
    <script>
      (function () {
        var form = document.querySelector(".contact-form");
        if (!form) return;
        var endpointPlaceholder = "PASTE_APPS_SCRIPT_WEB_APP_URL_HERE";
        var turnstilePlaceholder = "PASTE_TURNSTILE_SITE_KEY_HERE";
        var status = document.getElementById("contact-status");
        var submit = form.querySelector(".contact-submit");
        var widget = form.querySelector(".cf-turnstile");
        var submitFrame = document.getElementById("contact-submit-frame");
        var siteKey = (widget && widget.getAttribute("data-sitekey")) || "";
        var endpointMissing = (form.getAttribute("action") || "").indexOf(endpointPlaceholder) !== -1;
        var turnstileMissing = siteKey.indexOf(turnstilePlaceholder) !== -1;
        var ready = !(endpointMissing || turnstileMissing);
        var pending = false;
        var fallbackTimer = null;
        var actionOrigin = "";
        try {
          actionOrigin = new URL(form.getAttribute("action") || "", window.location.href).origin;
        } catch (_e) {}

        function setStatus(message, cls) {
          if (!status) return;
          status.textContent = message || "";
          status.classList.remove("is-success", "is-error", "is-pending");
          if (cls) status.classList.add(cls);
        }

        function setSubmitEnabled(enabled) {
          if (!submit) return;
          submit.disabled = !enabled;
        }

        function resetTurnstile() {
          try {
            if (window.turnstile && typeof window.turnstile.reset === "function") {
              window.turnstile.reset();
            }
          } catch (_e) {}
        }

        if (endpointMissing || turnstileMissing) {
          setSubmitEnabled(false);
          setStatus(
            "Contact form is being configured. Add Apps Script URL and Turnstile site key, then refresh.",
            "is-error"
          );
          return;
        }

        setSubmitEnabled(true);

        form.addEventListener("submit", function () {
          pending = true;
          setSubmitEnabled(false);
          setStatus("Sending message...", "is-pending");
          if (fallbackTimer) {
            clearTimeout(fallbackTimer);
          }
          fallbackTimer = setTimeout(function () {
            if (!pending) return;
            pending = false;
            setSubmitEnabled(true);
            resetTurnstile();
            setStatus("Submission timed out. Please try again.", "is-error");
          }, 20000);
        });

        if (submitFrame) {
          submitFrame.addEventListener("load", function () {
            if (!pending) return;
            setTimeout(function () {
              if (!pending) return;
              pending = false;
              setSubmitEnabled(true);
              resetTurnstile();
              setStatus("Submission finished. If no confirmation appears, please try again.", "is-error");
            }, 600);
          });
        }

        window.addEventListener("message", function (event) {
          if (!pending) return;
          if (actionOrigin && event.origin !== actionOrigin) return;
          var data = event.data || {};
          if (data.type !== "mcs_contact_result") return;
          pending = false;
          if (fallbackTimer) {
            clearTimeout(fallbackTimer);
          }
          setSubmitEnabled(true);
          resetTurnstile();
          if (data.ok) {
            setStatus(data.message || "Message sent.", "is-success");
            try {
              form.reset();
            } catch (_e) {}
          } else {
            setStatus(data.message || "Could not send. Please try again.", "is-error");
          }
        });
      })();
    </script>
    <script src="https://challenges.cloudflare.com/turnstile/v0/api.js" async defer></script>
  </body>
</html>
